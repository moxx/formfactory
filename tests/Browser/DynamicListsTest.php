<?php

namespace FormBuilderTests\Browser;

use Facebook\WebDriver\WebDriverKeys;
use FormBuilderTests\DuskTestCase;
use Laravel\Dusk\Browser;

class DynamicListsTest extends DuskTestCase
{

    /**
     * @throws \Exception
     * @throws \Throwable
     */
    public function testDynamicLists()
    {
        $this->browse(function (Browser $browser) {
            $browser->visit('/dynamic-lists-get');
            $this->assertDynamicListHtmlEquals($browser,'<div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="0"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[0][text]">Text<sup>*</sup></label><input type="text" id="myFormId_outer_dynamic_list[0][text]" class="form-control" required name="outer_dynamic_list[0][text]" pattern=".{2,}" placeholder="Text"></div><div><div class="input-group m-b-1" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][0]" pattern="[a-zA-Z]+" placeholder="0"></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group91e3fe08166c1a031758bbb849a245d6itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]">%group91e3fe08166c1a031758bbb849a245d6itemID%</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" disabled="disabled" placeholder="%group91e3fe08166c1a031758bbb849a245d6itemID%"></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="1"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[1][text]">Text<sup>*</sup></label><input type="text" id="myFormId_outer_dynamic_list[1][text]" class="form-control" required name="outer_dynamic_list[1][text]" pattern=".{2,}" placeholder="Text"></div><div><div class="input-group m-b-1" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][0]" pattern="[a-zA-Z]+" placeholder="0"></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group912e5d93899c63151d78a909ab9ee0bcitemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]">%group912e5d93899c63151d78a909ab9ee0bcitemID%</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" disabled="disabled" placeholder="%group912e5d93899c63151d78a909ab9ee0bcitemID%"></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" hidden="hidden" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%groupd298c4d06d5b69739759e9f1f7beeccbitemID%"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list" disabled="disabled"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]">Text</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" disabled="disabled" placeholder="Text"></div><div><div class="input-group m-b-1" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" disabled="disabled" placeholder="0"></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]">%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" disabled="disabled" placeholder="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%"></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-min="2" data-dynamiclist-max="3" title="Add Outer_dynamic_list" name="addRow">Add Outer_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div>');
        });
    }

    /**
     * @throws \Exception
     * @throws \Throwable
     */
    public function testDynamicListsErrors()
    {
        $this->browse(function (Browser $browser) {
            $browser->visit('/dynamic-lists-get');
            $browser->click('#myFormId_submit');
            $this->assertDynamicListHtmlEquals($browser,'<div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="0"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group has-error"><label for="myFormId_outer_dynamic_list[0][text]">Text<sup>*</sup></label><div role="alert" class="alert m-b-1 alert-danger" id="myFormId_outer_dynamic_list[0][text]_errors"><div>The outer_dynamic_list.0.text field is required.</div></div><input type="text" id="myFormId_outer_dynamic_list[0][text]" class="form-control" aria-describedby="myFormId_outer_dynamic_list[0][text]_errors" required name="outer_dynamic_list[0][text]" aria-invalid="true" pattern=".{2,}" placeholder="Text" /></div><div class="form-group"><div role="alert" class="alert m-b-1 alert-danger" id="myFormId_inputGroup_inner_dynamic_list_errors"><div>The outer_dynamic_list.0.inner_dynamic_list.0 may only contain letters.</div></div><div class="input-group m-b-1" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-id="0" aria-describedby="myFormId_inputGroup_inner_dynamic_list_errors"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][0]" aria-invalid="true" pattern="[a-zA-Z]+" placeholder="0" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group91e3fe08166c1a031758bbb849a245d6itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]">%group91e3fe08166c1a031758bbb849a245d6itemID%</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" disabled="disabled" placeholder="%group91e3fe08166c1a031758bbb849a245d6itemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="1"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group has-error"><label for="myFormId_outer_dynamic_list[1][text]">Text<sup>*</sup></label><div role="alert" class="alert m-b-1 alert-danger" id="myFormId_outer_dynamic_list[1][text]_errors"><div>The outer_dynamic_list.1.text field is required.</div></div><input type="text" id="myFormId_outer_dynamic_list[1][text]" class="form-control" aria-describedby="myFormId_outer_dynamic_list[1][text]_errors" required name="outer_dynamic_list[1][text]" aria-invalid="true" pattern=".{2,}" placeholder="Text" /></div><div class="form-group"><div role="alert" class="alert m-b-1 alert-danger" id="myFormId_inputGroup_inner_dynamic_list_errors"><div>The outer_dynamic_list.1.inner_dynamic_list.0 may only contain letters.</div></div><div class="input-group m-b-1" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-id="0" aria-describedby="myFormId_inputGroup_inner_dynamic_list_errors"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][0]" aria-invalid="true" pattern="[a-zA-Z]+" placeholder="0" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group912e5d93899c63151d78a909ab9ee0bcitemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]">%group912e5d93899c63151d78a909ab9ee0bcitemID%</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" disabled="disabled" placeholder="%group912e5d93899c63151d78a909ab9ee0bcitemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" hidden="hidden" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%groupd298c4d06d5b69739759e9f1f7beeccbitemID%"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list" disabled="disabled"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]">Text</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" disabled="disabled" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" disabled="disabled" placeholder="0" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]">%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" disabled="disabled" placeholder="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-min="2" data-dynamiclist-max="3" title="Add Outer_dynamic_list" name="addRow">Add Outer_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div>');
        });
    }

    /**
     * @throws \Exception
     * @throws \Throwable
     */
    public function testDynamicListAddInnerListButton()
    {
        $this->browse(function (Browser $browser) {
            $browser->visit('/dynamic-lists-get');
            $browser->click('button[data-dynamiclist-add="data-dynamiclist-add"][data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6"]');
            $this->assertDynamicListHtmlEquals($browser,'<div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="0"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[0][text]">Text<sup>*</sup></label><input type="text" id="myFormId_outer_dynamic_list[0][text]" class="form-control" required name="outer_dynamic_list[0][text]" pattern=".{2,}" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][0]" pattern="[a-zA-Z]+" placeholder="0" /></div><div class="input-group m-b-1" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-id="1"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][1]">1</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][1]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][1]" placeholder="1" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group91e3fe08166c1a031758bbb849a245d6itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]">%group91e3fe08166c1a031758bbb849a245d6itemID%</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" disabled="disabled" placeholder="%group91e3fe08166c1a031758bbb849a245d6itemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow" style="display: none;">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" style="display: block;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="1"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[1][text]">Text<sup>*</sup></label><input type="text" id="myFormId_outer_dynamic_list[1][text]" class="form-control" required name="outer_dynamic_list[1][text]" pattern=".{2,}" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][0]" pattern="[a-zA-Z]+" placeholder="0" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group912e5d93899c63151d78a909ab9ee0bcitemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]">%group912e5d93899c63151d78a909ab9ee0bcitemID%</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" disabled="disabled" placeholder="%group912e5d93899c63151d78a909ab9ee0bcitemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" hidden="hidden" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%groupd298c4d06d5b69739759e9f1f7beeccbitemID%"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list" disabled="disabled"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]">Text</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" disabled="disabled" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" disabled="disabled" placeholder="0" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]">%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" disabled="disabled" placeholder="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-min="2" data-dynamiclist-max="3" title="Add Outer_dynamic_list" name="addRow">Add Outer_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div>');
        });
    }

    /**
     * @throws \Exception
     * @throws \Throwable
     */
    public function testDynamicListWithDefaultValues()
    {
        $this->browse(function (Browser $browser) {
            $browser->visit('/dynamic-lists-get-with-default-values');
            $this->assertDynamicListHtmlEquals($browser,'<div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="0"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[0][text]">Text<sup>*</sup></label><input type="text" id="myFormId_outer_dynamic_list[0][text]" class="form-control" required name="outer_dynamic_list[0][text]" value="foobar" pattern=".{2,}" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][0]" value="foo" pattern="[a-zA-Z]+" placeholder="0" /></div><div class="input-group m-b-1" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-id="1"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][1]">1</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][1]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][1]" value="bar" pattern="[a-zA-Z]+" placeholder="1" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group91e3fe08166c1a031758bbb849a245d6itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]">%group91e3fe08166c1a031758bbb849a245d6itemID%</label><input type="text" id="myFormId_outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" class="form-control" name="outer_dynamic_list[0][inner_dynamic_list][%group91e3fe08166c1a031758bbb849a245d6itemID%]" disabled="disabled" placeholder="%group91e3fe08166c1a031758bbb849a245d6itemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow" style="display: none;">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="91e3fe08166c1a031758bbb849a245d6" style="display: block;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-id="1"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[1][text]">Text<sup>*</sup></label><input type="text" id="myFormId_outer_dynamic_list[1][text]" class="form-control" required name="outer_dynamic_list[1][text]" value="boofar" pattern=".{2,}" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][0]" value="boo" pattern="[a-zA-Z]+" placeholder="0" /></div><div class="input-group m-b-1" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-id="1"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][1]">1</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][1]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][1]" value="far" pattern="[a-zA-Z]+" placeholder="1" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group912e5d93899c63151d78a909ab9ee0bcitemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]">%group912e5d93899c63151d78a909ab9ee0bcitemID%</label><input type="text" id="myFormId_outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" class="form-control" name="outer_dynamic_list[1][inner_dynamic_list][%group912e5d93899c63151d78a909ab9ee0bcitemID%]" disabled="disabled" placeholder="%group912e5d93899c63151d78a909ab9ee0bcitemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow" style="display: none;">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="912e5d93899c63151d78a909ab9ee0bc" style="display: block;">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><div class="panel m-b-1 panel-default" hidden="hidden" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%groupd298c4d06d5b69739759e9f1f7beeccbitemID%"><button type="button" class="btn btn-sm pull-right btn-danger" data-dynamiclist-remove="1" title="Remove Outer_dynamic_list" disabled="disabled"><i class="btr bt-trash" style="margin:0"></i></button><span class="clearfix"></span><div class="panel-body"><div class="form-group"><label for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]">Text</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][text]" disabled="disabled" placeholder="Text" /></div><div><div class="input-group m-b-1" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-id="0"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]">0</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][0]" disabled="disabled" placeholder="0" /></div><div class="input-group m-b-1" hidden="hidden" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-template="data-dynamiclist-template" data-dynamiclist-id="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%"><div class="input-group-btn"><button type="button" class="btn btn-danger" data-dynamiclist-remove="1" title="Remove Inner_dynamic_list" disabled="disabled"><i class="btr bt-times"></i></button></div><label class="sr-only" for="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]">%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%</label><input type="text" id="myFormId_outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" class="form-control" name="outer_dynamic_list[%groupd298c4d06d5b69739759e9f1f7beeccbitemID%][inner_dynamic_list][%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%]" disabled="disabled" placeholder="%group28c416835abf9f0f3a3b78c0674c5629%parentItemID%itemID%" /></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%" data-dynamiclist-min="1" data-dynamiclist-max="2" title="Add Inner_dynamic_list" name="addRow">Add Inner_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="28c416835abf9f0f3a3b78c0674c5629%parentItemID%">You have reached the maximum amount. Please delete an item to add a new one.</div></div></div></div><button type="button" class="btn btn-sm push-top btn-default" id="myFormId_addRow" data-dynamiclist-add="data-dynamiclist-add" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" data-dynamiclist-min="2" data-dynamiclist-max="3" title="Add Outer_dynamic_list" name="addRow">Add Outer_dynamic_list <i class="btr bt-plus btn-no-anim"></i></button><div role="alert" class="alert alert-info" hidden="hidden" data-dynamiclist-maxalert="data-dynamiclist-maxalert" data-dynamiclist-group="d298c4d06d5b69739759e9f1f7beeccb" style="display: none;">You have reached the maximum amount. Please delete an item to add a new one.</div></div>');
        });
    }

    private function assertDynamicListHtmlEquals(Browser $browser, string $expectedHtml) {
        $this->assertHtmlEquals(
            $expectedHtml,
            str_before(str_after($browser->driver->getPageSource(),' id="myFormId__formID" />'),'<button type="submit"')
        );
    }


}